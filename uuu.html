<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Space Blaster Mini</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: black;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
    const keys = {
  left: false,
  right: false
};
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const player = {
    x: canvas.width / 2 - 20,
    y: canvas.height - 60,
    width: 40,
    height: 40,
    color: "lime",
    speed: 10
  };

  const bullets = [];
  const enemies = [];
  let score = 0;
  let gameOver = false; // NEW FLAG

  function drawPlayer() {
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.width, player.height);
  }

  function drawBullets() {
    ctx.fillStyle = "white";
    for (let i = 0; i < bullets.length; i++) {
      const b = bullets[i];
      ctx.fillRect(b.x, b.y, 4, 10);
      b.y -= 10;
      if (b.y < 0) {
        bullets.splice(i, 1);
        i--;
      }
    }
  }

  function drawEnemies() {
    for (let i = 0; i < enemies.length; i++) {
      const e = enemies[i];
      ctx.fillStyle = "red";
      ctx.beginPath();
      ctx.arc(e.x, e.y, 20, 0, Math.PI * 2);
      ctx.fill();
      e.y += 2;

      for (let j = 0; j < bullets.length; j++) {
        const b = bullets[j];
        const dx = e.x - b.x;
        const dy = e.y - b.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        if (distance < 20) {
          enemies.splice(i, 1);
          bullets.splice(j, 1);
          score++;
          i--;
          break;
        }
      }

      if (e.y > canvas.height && !gameOver) {
        gameOver = true;
        alert("ðŸ’¥ GAME OVER\nYour Score: " + score);
        document.location.reload();
        break;
      }
    }
  }

  function drawScore() {
    ctx.fillStyle = "cyan";
    ctx.font = "20px Arial";
    ctx.fillText("Score: " + score, 20, 30);
  }

 function gameLoop() {
  if (gameOver) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
 }
   function gameLoop() {
    if (gameOver) return; // STOP GAME LOOP if game over
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPlayer();
    drawBullets();
    drawEnemies();
    drawScore();
    requestAnimationFrame(gameLoop);
  }

  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft" && player.x > 0) {
      player.x -= player.speed;
    }
    if (e.key === "ArrowRight" && player.x + player.width < canvas.width) {
      player.x += player.speed;
    }
    if ((e.key === " " || e.key === "ArrowUp") && !gameOver) {
      bullets.push({
        x: player.x + player.width / 2 - 2,
        y: player.y
      });
    }
  });

  setInterval(() => {
    if (!gameOver) {
      enemies.push({
        x: Math.random() * (canvas.width - 40) + 20,
        y: 0
      });
    }
  }, 1500);

  gameLoop();
</script>
